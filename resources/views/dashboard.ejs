<main class="main users chart-page" id="skip-target">
  <div class="container">
    <h2 class="main-title">Dashboard, Welcome back <span class="userInfo capitalize" userDtl="profile.name"></span></h2>
    <div class="row stat-cards">
      <% if(gatePermision(permisions, [USERS_VIEW])){ %>
      <div class="col-md-6 col-xl-4">
        <article class="stat-cards-item">
          <div class="stat-cards-icon primary">
            <i data-feather="bar-chart-2" aria-hidden="true"></i>
          </div>
          <div class="stat-cards-info">
            <p class="stat-cards-info__num"><%= users.length %></p>
            <p class="stat-cards-info__title">Total Users</p>
            <p class="stat-cards-info__progress">
              <span class="stat-cards-info__profit success">
                <i data-feather="trending-up" aria-hidden="true"></i>Registered
              </span>
              User
            </p>
          </div>
        </article>
      </div>
      <% } %>

      <% if(gatePermision(permisions, [ROLES_VIEW])){ %>
      <div class="col-md-6 col-xl-4">
        <article class="stat-cards-item">
          <div class="stat-cards-icon warning">
            <i data-feather="file" aria-hidden="true"></i>
          </div>
          <div class="stat-cards-info">
            <p class="stat-cards-info__num"><%= rolesCount %></p>
            <p class="stat-cards-info__title">Total Roles</p>
            <p class="stat-cards-info__progress">
              <span class="stat-cards-info__profit success">
                <i data-feather="trending-up" aria-hidden="true"></i>Created
              </span>
              Roles
            </p>
          </div>
        </article>
      </div>
      <% } %>

      <% if(gatePermision(permisions, [PERMISSIONS_VIEW])){ %>
      <div class="col-md-6 col-xl-4">
        <article class="stat-cards-item">
          <div class="stat-cards-icon purple">
            <i data-feather="file" aria-hidden="true"></i>
          </div>
          <div class="stat-cards-info">
            <p class="stat-cards-info__num"><%= permissionsCount %></p>
            <p class="stat-cards-info__title">Total Permissions</p>
            <p class="stat-cards-info__progress">
              <span class="stat-cards-info__profit danger">
                <i data-feather="trending-down" aria-hidden="true"></i>Created
              </span>
              Permissions
            </p>
          </div>
        </article>
      </div>
      <% } %>

    </div>
    <div class="row mt-2">
      <div class="col-lg-12">
        <article class="white-block">
          <div class="top-cat-title">
            <h3>User List & Roles</h3>
            <p>To View Detail Click On "Users Email"</p>
          </div>
          <ul class="top-cat-list">
            <% for (var i=0; i < users.length; i++) { %>
            <li>
              <% const Validate = gatePermision(permisions, [USERS_VIEW]) %>
                <% if(Validate){ %>
                  <a href="<%= base_url('profile') %>?userId=<%= users[i]._id %>" target="_blank">
                <% } %>
                  <div class="top-cat-list__title">
                    <%= users[i].profile.email %> / <%= (users[i].status == 1 ? 'Active' : 'InActive') %> <span><%= users[i].profile.name %></span> 
                  </div>
                  <div class="top-cat-list__subtitle">
                    <%= users[i].roles.map(c => c.name).join(", ") %> <span class="purple">+<%= users[i].roles.length %></span>
                  </div>
                <% if(Validate){ %>
                  </a>
                <% } %>
            </li>
            <% } %>
          </ul>
        </article>
      </div>
    </div>
  </div>
</main>